const DataCache={repos:null,tools:null,courses:null,async loadRepos(){if(this.repos)return this.repos;const t=await fetch("data/repos.json");return this.repos=await t.json(),this.repos},async loadTools(){if(this.tools)return this.tools;const t=await fetch("data/tools.json");return this.tools=(await t.json()).categories,this.tools},async loadCourses(){if(this.courses)return this.courses;const t=await fetch("data/courses.json");return this.courses=await t.json(),this.courses}};function showLoading(t){const e=document.getElementById(t);e.innerHTML=`\n        <div class="loading-state">\n            <div class="loading-spinner"></div>\n            <p>加载数据中...</p>\n        </div>\n    `}function hideLoading(t){const e=document.querySelector(`#${t} .loading-state`);e&&e.remove()}async function renderRepoList(){const t=document.getElementById("repo-list");showLoading("repo-list");try{const e=await DataCache.loadRepos();hideLoading("repo-list"),t.innerHTML="",e.forEach(e=>{const o=document.createElement("div");o.className="repo-card",o.innerHTML=`\n                <div class="repo-name">\n                    <a href="${e["repository url"]}" target="_blank">${e["repository name"]}</a>\n                </div>\n                <div class="repo-desc">${e["repository 简介"]}</div>\n                <div class="repo-url">${e["repository url"]}</div>\n            `,t.appendChild(o)}),document.getElementById("repo-count").textContent=e.length}catch(e){t.innerHTML=`\n            <div class="empty-state">\n                <h3>数据加载失败</h3>\n                <p>请检查网络连接或刷新页面重试</p>\n            </div>\n        `}}async function renderToolList(t="all"){const e=document.getElementById("tool-list");showLoading("tool-list");try{const o=await DataCache.loadTools();hideLoading("tool-list"),e.innerHTML="";let a=[];if("all"===t?Object.values(o).forEach(t=>{a=a.concat(t)}):a=o[t]||[],a.length>0?(document.getElementById("empty-state").style.display="none",a.forEach(t=>{const o=document.createElement("div");o.className="tool-card",o.innerHTML=`\n                    <div class="tool-category">${t.category||category}</div>\n                    <div class="tool-name">\n                        <a href="${"无开源仓库（商业API服务）"!==t.githubUrl?t.githubUrl:"#"}" target="_blank">${t.name}</a>\n                    </div>\n                    <div class="tool-info">\n                        <div class="tool-info-title">核心定位</div>\n                        <div class="tool-info-content">${t.corePosition}</div>\n                    </div>\n                    <div class="tool-info">\n                        <div class="tool-info-title">核心功能</div>\n                        <div class="tool-info-content">${t.coreFunction}</div>\n                    </div>\n                    <div class="tool-info">\n                        <div class="tool-info-title">适用场景</div>\n                        <div class="tool-info-content">${t.applicableScene}</div>\n                    </div>\n                    <div class="tool-info">\n                        <div class="tool-info-title">技术优势</div>\n                        <div class="tool-info-content">${t.technicalAdvantage}</div>\n                    </div>\n                    <div class="tool-url">${t.githubUrl}</div>\n                `,e.appendChild(o)})):document.getElementById("empty-state").style.display="block";const n=Object.values(o).flat();document.getElementById("tool-count").textContent=n.length,document.getElementById("category-count").textContent=Object.keys(o).length,document.getElementById("current-category").textContent="all"===t?"全部工具":t,document.getElementById("current-count").textContent=a.length}catch(t){e.innerHTML=`\n            <div class="empty-state">\n                <h3>数据加载失败</h3>\n                <p>请检查网络连接或刷新页面重试</p>\n            </div>\n        `}}async function renderCourseList(){const t=document.getElementById("course-list");showLoading("course-list");try{const e=await DataCache.loadCourses();hideLoading("course-list"),t.innerHTML="",e.forEach(e=>{const o=document.createElement("div");o.className="course-card",o.innerHTML=`\n                <div class="course-name">\n                    <a href="${e["course url"]}" target="_blank">${e["course name"]}</a>\n                </div>\n                <div class="course-desc">${e["course 简介"]}</div>\n                <div class="course-url">${e["course url"]}</div>\n            `,t.appendChild(o)}),document.getElementById("course-count").textContent=e.length}catch(e){t.innerHTML=`\n            <div class="empty-state">\n                <h3>数据加载失败</h3>\n                <p>请检查网络连接或刷新页面重试</p>\n            </div>\n        `}}function initModuleSwitch(){const t=document.querySelectorAll(".module-btn"),e=document.querySelectorAll(".module");t.forEach(t=>{t.addEventListener("click",async()=>{t.forEach(t=>t.classList.remove("active")),e.forEach(t=>t.classList.remove("active")),t.classList.add("active");const o=`${t.dataset.module}-module`;document.getElementById(o).classList.add("active"),"tool"===t.dataset.module?(document.getElementById("current-tool-stats").style.display="block",0===document.getElementById("tool-list").children.length&&await renderToolList()):document.getElementById("current-tool-stats").style.display="none","repo"===t.dataset.module&&0===document.getElementById("repo-list").children.length?await renderRepoList():"course"===t.dataset.module&&0===document.getElementById("course-list").children.length&&await renderCourseList()})})}function initCategorySwitch(){const t=document.querySelectorAll(".category-btn");t.forEach(e=>{e.addEventListener("click",()=>{t.forEach(t=>t.classList.remove("active")),e.classList.add("active"),renderToolList(e.dataset.category)})})}window.addEventListener("DOMContentLoaded",async()=>{initModuleSwitch(),initCategorySwitch(),await renderRepoList()});
